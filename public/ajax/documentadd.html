<div class="row">
	<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
		<h1 class="page-title txt-color-blueDark">
			<i class="fa fa-picture-o fa-fw "></i> 图册录入
		</h1>
	</div>
</div>

<!-- widget grid -->
<section id="widget-grid" class="">

	<!-- row -->
	<div class="row">

		<!-- NEW WIDGET START -->
		<article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">

			<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget" id="wid-id-0"
				data-widget-deletebutton="false" data-widget-editbutton="false">
				<!-- widget options:
					usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
					
					data-widget-colorbutton="false"	
					data-widget-editbutton="false"
					data-widget-togglebutton="false"
					data-widget-deletebutton="false"
					data-widget-fullscreenbutton="false"
					data-widget-custombutton="false"
					data-widget-collapsed="true" 
					data-widget-sortable="false"
					
				-->
				<header>
					<span class="widget-icon"> <i class="fa fa-edit"></i>
					</span>
					<h2>录入</h2>

				</header>

				<!-- widget div-->
				<div>

					<!-- widget content -->
					<div class="widget-body">
						<form action="" class="smart-form">
							<fieldset>
								<div class="row">
									<section class="col col-4  col-sm-6">
										<label class="input"> 
											<i class="icon-prepend fa fa-folder"></i>
											<input type="text"
												name="doc_name" placeholder="档案名称">
										</label>
									</section>
									<section class="col col-4  col-sm-6">
										<label class="input"> 
											<i class="icon-prepend fa fa-folder"></i>
											<input type="text"
												name="project_name" placeholder="项目名称">
										</label>
									</section>
									<section class="col col-4  col-sm-6">
										<label class="select"> <select name="doc_type">
												<option value="">档案类型</option>
											  	<option value="控规">控规</option>
											  	<option value="详规">详规</option> 
										    </select> <i></i>
										</label>
									</section>
									
									<section class="col col-4 col-sm-6">
										<label class="select"> <select name=doc_mgr>
												<option value="">档案管理员</option>
											  	<option value="管理员1">管理员1</option>
											  	<option value="管理员2">管理员2</option> 
										    </select> <i></i>
										</label>
									</section>
									<section class="col col-4 col-sm-6">
										<label class="select"> <select name="doc_location">
												<option value="">档案位置</option>
											  	<option value="西1柜">西1柜</option>
											  	<option value="北1柜">北1柜</option> 
										    </select> <i></i>
										</label>
									</section>
									<section class="col col-4 col-sm-6">
										<label for="file" class="input input-file">
										<div class="button"><input type="file" name="file" onchange="this.parentNode.nextSibling.value = this.value">上传</div><input type="text" placeholder="图册封面" readonly="">
									</label>
									</section>
									<section class="col col-4 col-sm-6">
										<label for="file" class="input input-file">
										<div class="button"><input type="file" name="file" onchange="this.parentNode.nextSibling.value = this.value">上传</div><input type="text" placeholder="电子档案" readonly="">
									</label>
									</section>
									<section class="col col-4 col-sm-6">
										<label class="input"> 
											<i class="icon-prepend fa fa-database"></i>
											<input type="text"
												name="doc_num" placeholder="库存数量">
										</label>
									</section>
									
								</div>
								
								<div class="row">
									<section  class="col col-12 col-sm-12"> 
									<a id="submit" class="btn btn-primary btn-sm" >
											<i class="fa fa-save"></i>
											提交
											</a>
									</section>
								</div>
							</fieldset>
						</form>
						<section class="col col-4 col-sm-6">
										<label class="input"> 
											<img class="media-object" alt="64x64" src="img/demo/sample.jpg">
										</label>
									</section>
					</div>
					<!-- end widget content -->

				</div>
				<!-- end widget div -->

			</div>
			<!-- end widget -->
			
			<!-- Widget ID (each widget will need unique ID)-->
			<div class="jarviswidget" id="wid-id-1" data-widget-editbutton="false" data-widget-deletebutton="false" >
				<!-- widget options:
				usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

				data-widget-colorbutton="false"
				data-widget-editbutton="false"
				data-widget-togglebutton="false"
				data-widget-deletebutton="false"
				data-widget-fullscreenbutton="false"
				data-widget-custombutton="false"
				data-widget-collapsed="true"
				data-widget-sortable="false"

				-->
		 
			</div>
			<!-- end widget -->

		</article>
		<!-- WIDGET END -->

	</div>
	<!-- end row -->
</section>
<!-- end widget grid -->

<script type="text/javascript">
    /* DO NOT REMOVE : GLOBAL FUNCTIONS!
     *
     * pageSetUp(); WILL CALL THE FOLLOWING FUNCTIONS
     *
     * // activate tooltips
     * $("[rel=tooltip]").tooltip();
     *
     * // activate popovers
     * $("[rel=popover]").popover();
     *
     * // activate popovers with hover states
     * $("[rel=popover-hover]").popover({ trigger: "hover" });
     *
     * // activate inline charts
     * runAllCharts();
     *
     * // setup widgets
     * setup_widgets_desktop();
     *
     * // run form elements
     * runAllForms();
     *
     ********************************
     *
     * pageSetUp() is needed whenever you load a page.
     * It initializes and checks for all basic elements of the page
     * and makes rendering easier.
     *
     */

    pageSetUp();

    // PAGE RELATED SCRIPTS

    // pagefunction

    var pagefunction = function() {
        var dt = $('#datatable_col_reorder').DataTable({
            "iDisplayLength":30,
            "bProcessing":true,
            "bPaginate": true,
            "bFilter": true,
            "bSort": true, //排序功能
            "bLengthChange":false,
            "bInfo": false,
            //"scrollX": true,
            //"scrollCollapse": true,
	        "aaSorting": [
				[ 2, "asc" ]
			],
			"oLanguage": {
			    "sZeroRecords": "没有检索到数据",
			    "oPaginate": {
			    "sPrevious": "前一页",
			    "sNext": "后一页",
			    },
			  "sZeroRecords": "没有检索到数据",
			},
			"processing": '<h1 class="ajax-loading-animation"><i class="fa fa-cog fa-spin"></i> Loading...</h1>',
		  	//"ajax": '../ajax/data/arrays.txt',
		  	"serverSide": false,
		  	"columnDefs": [ {
		  	    "targets": 3,
		  	    "render": function ( data, type, full, meta ) {
		  	        return '<span class="sparkline display-inline" data-sparkline-type="box" data-sparkline-width="150">0,'+data+',720</span><br />'
		  	        +'<small class="text-muted  font-sm font-xs ">最低分:'+data.split(',')[0]
		  	        +'平均分:'+data.split(',')[1]
		  	        +'最高分:'+data.split(',')[2]+'</small>';
		  	    }
		  	  }, {
		  	    "targets": 1,
		  	    "render": function ( data, type, full, meta ) {
					return '<strong>'+data+'</strong><br /><img src="img/school/211.jpg" title="211工程院校" height="30px"></img><img src="img/school/985.png" height="30px"></img></h4>';
		  	        //return '<a href="javascript:void(0);">'+data+'</a><small>211</small><small>985</small>';
		  	    }
		  	  }, {
	                "targets": [ 0 ],
	                "visible": false,
	                "searchable": false
		  	  }],
		  	"fnDrawCallback": function (oSettings) {
		  	  runAllCharts();
             }
		  	
        });
        
        
        function format ( d ) {
            return '<div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">					<div class="well well-sm well-light">						<h4 class="txt-color-blue">Pie <span class="semi-bold">Chart</span> </h4>						<br>						<div class="text-center">							<div class="sparkline txt-color-blue display-inline" 							data-sparkline-type="pie" 							data-sparkline-offset="90" 							data-sparkline-piesize="75px">3,5,2</div>							<div class="sparkline txt-color-blue display-inline" 							data-sparkline-type="pie" 							data-sparkline-offset="90" 							data-sparkline-piesize="75px">30,20,15,35</div>						</div>					</div>				</div>				<div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">					<div class="well well-sm well-light padding-10">						<h4 class="txt-color-green">Composite <span class="semi-bold">Chart</span> </h4>						<br>						<div class="sparkline" 						data-sparkline-type="compositeline" 						data-sparkline-spotradius-top="5" 						data-sparkline-color-top="#3a6965" 						data-sparkline-line-width-top="3" 						data-sparkline-color-bottom="#2b5c59" 						data-sparkline-spot-color="#2b5c59" 						data-sparkline-minspot-color-top="#97bfbf" 						data-sparkline-maxspot-color-top="#c2cccc" 						data-sparkline-highlightline-color-top="#cce8e4" 						data-sparkline-highlightspot-color-top="#9dbdb9" 						data-sparkline-width="96%" 						data-sparkline-height="78px" 						data-sparkline-line-val="[6,4,7,8,4,3,2,2,5,6,7,4,1,5,7,9,9,8,7,6]" 						data-sparkline-bar-val="[4,1,5,7,9,9,8,7,6,6,4,7,8,4,3,2,2,5,6,7]">						</div> 						</div>				</div>				<div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">					<div class="well well-sm well-light">						<h4 class="txt-color-blueLight">Bar <span class="semi-bold">Chart</span> </h4>						<br>						<div class="sparkline txt-color-blueLight text-center" 						data-sparkline-type="bar" 						data-sparkline-width="96%" 						data-sparkline-barwidth="11" 						data-sparkline-barspacing = "5" 						data-sparkline-height="80px">							4,3,5,7,9,9,8,7,6,6,4,7,8,4						</div>					</div>				</div>				<div class="col-xs-12 col-sm-6 col-md-6 col-lg-3">					<div class="well well-sm well-light">						<h4 class="txt-color-blueLight">Bar <span class="semi-bold">Stacked Chart</span> </h4>						<br>						<div class="sparkline txt-color-blue text-center" 						data-sparkline-type="bar" 						data-sparkline-width="96%" 						data-sparkline-barwidth="11" 						data-sparkline-barspacing = "5" 						data-sparkline-barstacked-color=\'["#92A2A8", "#4493B1"]\' 						data-sparkline-height="80px">4:5,3:4,5:7,6:3,4:6,6:5,8:2,4:3,6:4,6:2,4:4,7:2,8:5,4:2</div>					</div>				</div></div>';
        }
        $('#datatable_col_reorder tbody').on( 'click', "tr[role='row']", function () {
            var tr = $(this);
            var row = dt.row(tr);
            dt.rows().eq(0).each(function(idx){
                if (row.index() != idx && dt.row(idx).child.isShown()) {
                    dt.row(idx).child.hide();
                }
            });
            if ( row.child.isShown() ) {
                row.child.hide();
            }
            else {
                row.child( format( row.data() ) ).show();
                runAllCharts();
            }
        } );
        
        $("#submit").on('click', function(){
            $.ajax({
		        url:'/doc/save',
		        type:'POST',
		        data : function ( d ) {
                    return $.extend( {}, d, {
                        "doc_name": $('#doc_name').val(),
                        "project_name": $('#project_name').val(),
                        "doc_type": $('#doc_type').val(),
                        "doc_mgr": $('#doc_mgr').val(),
                        "doc_location": $('#doc_location').val(),
                        "doc_num": $('#doc_num').val()
                      } );
                 },
				success : function(data) {
				    $.bigBox({
						title : "提示信息",
						content : "保存档案信息成功！档案Id为xxxx",
						color : "#739E73",
						timeout : 6000,
						icon : "fa fa-check"
					});
				    
				},
				error: function(data) {
				    $.bigBox({
             			title : "错误信息",
             			content : "保存档案信息成功！",
             			color : "#C46A69",
             			icon : "fa fa-warning shake animated",
             			timeout : 6000
             		});
				}
		    });
        });
        
     
        // On each draw, loop over the `detailRows` array and show any child rows
       /*  dt.on( 'draw', function () {
            $.each( detailRows, function ( i, id ) {
                $('#'+id+' td:first-child').trigger( 'click' );
            } );
        } ); */
        
        /* COLUMN FILTER  
	    var otable = $('#datatable_col_reorder').DataTable({
	        "bPaginate": true, //翻页功能
	        "bLengthChange": false, //改变每页显示数据数量
	        "bFilter": false, //过滤功能
	        "bSort": true, //排序功能
	        "bInfo": true,//页脚信息
	        "bAutoWidth": true,//自动宽度
	        "aaSorting": [
				[ 1, "asc" ]
			],
			"bProcessing":true,
			"iDeferLoading":true,
			"iDisplayLength":30,
			"sAjaxSource":"datasource.txt"
	    });
        
	    $("div.toolbar").html('<div class="text-right"><img src="img/logo.png" alt="SmartAdmin" style="width: 111px; margin-top: 3px; margin-right: 10px;"></div>');
        */
        
        $("#datatable_col_reorder_wrapper").addClass("table-responsive");
    };
    
    
    
    loadScript("js/plugin/sparkline/jquery.sparkline.min.js", function(){
    	loadScript("js/plugin/datatables/jquery.dataTables.min.js", function(){
			loadScript("js/plugin/datatables/dataTables.colVis.min.js", function(){
				loadScript("js/plugin/datatables/dataTables.tableTools.min.js", function(){
					loadScript("js/plugin/datatables/dataTables.bootstrap.min.js", pagefunction);
				});
			});
		});
    });
</script>
